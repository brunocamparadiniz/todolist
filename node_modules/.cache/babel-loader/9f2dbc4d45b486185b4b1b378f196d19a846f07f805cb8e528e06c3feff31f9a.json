{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\n/** @typedef {import(\"http\").ServerOptions} HttpServerOptions */\n/** @typedef {import(\"https\").ServerOptions} HttpsServerOptions */\n/** @typedef {import(\"../../declarations/WebpackOptions\").LazyCompilationDefaultBackendOptions} LazyCompilationDefaultBackendOptions */\n/** @typedef {import(\"../Compiler\")} Compiler */\n\n/**\n * @callback BackendHandler\n * @param {Compiler} compiler compiler\n * @param {function((Error | null)=, any=): void} callback callback\n * @returns {void}\n */\n\n/**\n * @param {Omit<LazyCompilationDefaultBackendOptions, \"client\"> & { client: NonNullable<LazyCompilationDefaultBackendOptions[\"client\"]>}} options additional options for the backend\n * @returns {BackendHandler} backend\n */\nvar _createForOfIteratorHelper = require(\"/Users/brunocamparadiniz/Desktop/coding/BC-AY/react/todolist/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\nvar _objectSpread = require(\"/Users/brunocamparadiniz/Desktop/coding/BC-AY/react/todolist/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\nmodule.exports = function (options) {\n  return function (compiler, callback) {\n    var logger = compiler.getInfrastructureLogger(\"LazyCompilationBackend\");\n    var activeModules = new Map();\n    var prefix = \"/lazy-compilation-using-\";\n    var isHttps = options.protocol === \"https\" || typeof options.server === \"object\" && (\"key\" in options.server || \"pfx\" in options.server);\n    var createServer = typeof options.server === \"function\" ? options.server : function () {\n      var http = isHttps ? require(\"https\") : require(\"http\");\n      return http.createServer.bind(http, options.server);\n    }();\n    var listen = typeof options.listen === \"function\" ? options.listen : function (server) {\n      var listen = options.listen;\n      if (typeof listen === \"object\" && !(\"port\" in listen)) listen = _objectSpread(_objectSpread({}, listen), {}, {\n        port: undefined\n      });\n      server.listen(listen);\n    };\n    var protocol = options.protocol || (isHttps ? \"https\" : \"http\");\n    var requestListener = function requestListener(req, res) {\n      var keys = req.url.slice(prefix.length).split(\"@\");\n      req.socket.on(\"close\", function () {\n        setTimeout(function () {\n          var _iterator = _createForOfIteratorHelper(keys),\n            _step;\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var key = _step.value;\n              var oldValue = activeModules.get(key) || 0;\n              activeModules.set(key, oldValue - 1);\n              if (oldValue === 1) {\n                logger.log(\"\".concat(key, \" is no longer in use. Next compilation will skip this module.\"));\n              }\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n        }, 120000);\n      });\n      req.socket.setNoDelay(true);\n      res.writeHead(200, {\n        \"content-type\": \"text/event-stream\",\n        \"Access-Control-Allow-Origin\": \"*\",\n        \"Access-Control-Allow-Methods\": \"*\",\n        \"Access-Control-Allow-Headers\": \"*\"\n      });\n      res.write(\"\\n\");\n      var moduleActivated = false;\n      var _iterator2 = _createForOfIteratorHelper(keys),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var key = _step2.value;\n          var oldValue = activeModules.get(key) || 0;\n          activeModules.set(key, oldValue + 1);\n          if (oldValue === 0) {\n            logger.log(\"\".concat(key, \" is now in use and will be compiled.\"));\n            moduleActivated = true;\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      if (moduleActivated && compiler.watching) compiler.watching.invalidate();\n    };\n    var server = /** @type {import(\"net\").Server} */createServer();\n    server.on(\"request\", requestListener);\n    var isClosing = false;\n    /** @type {Set<import(\"net\").Socket>} */\n    var sockets = new Set();\n    server.on(\"connection\", function (socket) {\n      sockets.add(socket);\n      socket.on(\"close\", function () {\n        sockets.delete(socket);\n      });\n      if (isClosing) socket.destroy();\n    });\n    server.on(\"clientError\", function (e) {\n      if (e.message !== \"Server is disposing\") logger.warn(e);\n    });\n    server.on(\"listening\", function (err) {\n      if (err) return callback(err);\n      var addr = server.address();\n      if (typeof addr === \"string\") throw new Error(\"addr must not be a string\");\n      var urlBase = addr.address === \"::\" || addr.address === \"0.0.0.0\" ? \"\".concat(protocol, \"://localhost:\").concat(addr.port) : addr.family === \"IPv6\" ? \"\".concat(protocol, \"://[\").concat(addr.address, \"]:\").concat(addr.port) : \"\".concat(protocol, \"://\").concat(addr.address, \":\").concat(addr.port);\n      logger.log(\"Server-Sent-Events server for lazy compilation open at \".concat(urlBase, \".\"));\n      callback(null, {\n        dispose: function dispose(callback) {\n          isClosing = true;\n          // Removing the listener is a workaround for a memory leak in node.js\n          server.off(\"request\", requestListener);\n          server.close(function (err) {\n            callback(err);\n          });\n          var _iterator3 = _createForOfIteratorHelper(sockets),\n            _step3;\n          try {\n            for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n              var socket = _step3.value;\n              socket.destroy(new Error(\"Server is disposing\"));\n            }\n          } catch (err) {\n            _iterator3.e(err);\n          } finally {\n            _iterator3.f();\n          }\n        },\n        module: function module(originalModule) {\n          var key = \"\".concat(encodeURIComponent(originalModule.identifier().replace(/\\\\/g, \"/\").replace(/@/g, \"_\")).replace(/%(2F|3A|24|26|2B|2C|3B|3D|3A)/g, decodeURIComponent));\n          var active = activeModules.get(key) > 0;\n          return {\n            client: \"\".concat(options.client, \"?\").concat(encodeURIComponent(urlBase + prefix)),\n            data: key,\n            active: active\n          };\n        }\n      });\n    });\n    listen(server);\n  };\n};","map":{"version":3,"names":["module","exports","options","compiler","callback","logger","getInfrastructureLogger","activeModules","Map","prefix","isHttps","protocol","server","createServer","http","require","bind","listen","port","undefined","requestListener","req","res","keys","url","slice","length","split","socket","on","setTimeout","key","oldValue","get","set","log","setNoDelay","writeHead","write","moduleActivated","watching","invalidate","isClosing","sockets","Set","add","delete","destroy","e","message","warn","err","addr","address","Error","urlBase","family","dispose","off","close","originalModule","encodeURIComponent","identifier","replace","decodeURIComponent","active","client","data"],"sources":["/Users/brunocamparadiniz/Desktop/coding/BC-AY/react/todolist/node_modules/webpack/lib/hmr/lazyCompilationBackend.js"],"sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\n/** @typedef {import(\"http\").ServerOptions} HttpServerOptions */\n/** @typedef {import(\"https\").ServerOptions} HttpsServerOptions */\n/** @typedef {import(\"../../declarations/WebpackOptions\").LazyCompilationDefaultBackendOptions} LazyCompilationDefaultBackendOptions */\n/** @typedef {import(\"../Compiler\")} Compiler */\n\n/**\n * @callback BackendHandler\n * @param {Compiler} compiler compiler\n * @param {function((Error | null)=, any=): void} callback callback\n * @returns {void}\n */\n\n/**\n * @param {Omit<LazyCompilationDefaultBackendOptions, \"client\"> & { client: NonNullable<LazyCompilationDefaultBackendOptions[\"client\"]>}} options additional options for the backend\n * @returns {BackendHandler} backend\n */\nmodule.exports = options => (compiler, callback) => {\n\tconst logger = compiler.getInfrastructureLogger(\"LazyCompilationBackend\");\n\tconst activeModules = new Map();\n\tconst prefix = \"/lazy-compilation-using-\";\n\n\tconst isHttps =\n\t\toptions.protocol === \"https\" ||\n\t\t(typeof options.server === \"object\" &&\n\t\t\t(\"key\" in options.server || \"pfx\" in options.server));\n\n\tconst createServer =\n\t\ttypeof options.server === \"function\"\n\t\t\t? options.server\n\t\t\t: (() => {\n\t\t\t\t\tconst http = isHttps ? require(\"https\") : require(\"http\");\n\t\t\t\t\treturn http.createServer.bind(http, options.server);\n\t\t\t  })();\n\tconst listen =\n\t\ttypeof options.listen === \"function\"\n\t\t\t? options.listen\n\t\t\t: server => {\n\t\t\t\t\tlet listen = options.listen;\n\t\t\t\t\tif (typeof listen === \"object\" && !(\"port\" in listen))\n\t\t\t\t\t\tlisten = { ...listen, port: undefined };\n\t\t\t\t\tserver.listen(listen);\n\t\t\t  };\n\n\tconst protocol = options.protocol || (isHttps ? \"https\" : \"http\");\n\n\tconst requestListener = (req, res) => {\n\t\tconst keys = req.url.slice(prefix.length).split(\"@\");\n\t\treq.socket.on(\"close\", () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tfor (const key of keys) {\n\t\t\t\t\tconst oldValue = activeModules.get(key) || 0;\n\t\t\t\t\tactiveModules.set(key, oldValue - 1);\n\t\t\t\t\tif (oldValue === 1) {\n\t\t\t\t\t\tlogger.log(\n\t\t\t\t\t\t\t`${key} is no longer in use. Next compilation will skip this module.`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 120000);\n\t\t});\n\t\treq.socket.setNoDelay(true);\n\t\tres.writeHead(200, {\n\t\t\t\"content-type\": \"text/event-stream\",\n\t\t\t\"Access-Control-Allow-Origin\": \"*\",\n\t\t\t\"Access-Control-Allow-Methods\": \"*\",\n\t\t\t\"Access-Control-Allow-Headers\": \"*\"\n\t\t});\n\t\tres.write(\"\\n\");\n\t\tlet moduleActivated = false;\n\t\tfor (const key of keys) {\n\t\t\tconst oldValue = activeModules.get(key) || 0;\n\t\t\tactiveModules.set(key, oldValue + 1);\n\t\t\tif (oldValue === 0) {\n\t\t\t\tlogger.log(`${key} is now in use and will be compiled.`);\n\t\t\t\tmoduleActivated = true;\n\t\t\t}\n\t\t}\n\t\tif (moduleActivated && compiler.watching) compiler.watching.invalidate();\n\t};\n\n\tconst server = /** @type {import(\"net\").Server} */ (createServer());\n\tserver.on(\"request\", requestListener);\n\n\tlet isClosing = false;\n\t/** @type {Set<import(\"net\").Socket>} */\n\tconst sockets = new Set();\n\tserver.on(\"connection\", socket => {\n\t\tsockets.add(socket);\n\t\tsocket.on(\"close\", () => {\n\t\t\tsockets.delete(socket);\n\t\t});\n\t\tif (isClosing) socket.destroy();\n\t});\n\tserver.on(\"clientError\", e => {\n\t\tif (e.message !== \"Server is disposing\") logger.warn(e);\n\t});\n\tserver.on(\"listening\", err => {\n\t\tif (err) return callback(err);\n\t\tconst addr = server.address();\n\t\tif (typeof addr === \"string\") throw new Error(\"addr must not be a string\");\n\t\tconst urlBase =\n\t\t\taddr.address === \"::\" || addr.address === \"0.0.0.0\"\n\t\t\t\t? `${protocol}://localhost:${addr.port}`\n\t\t\t\t: addr.family === \"IPv6\"\n\t\t\t\t? `${protocol}://[${addr.address}]:${addr.port}`\n\t\t\t\t: `${protocol}://${addr.address}:${addr.port}`;\n\t\tlogger.log(\n\t\t\t`Server-Sent-Events server for lazy compilation open at ${urlBase}.`\n\t\t);\n\t\tcallback(null, {\n\t\t\tdispose(callback) {\n\t\t\t\tisClosing = true;\n\t\t\t\t// Removing the listener is a workaround for a memory leak in node.js\n\t\t\t\tserver.off(\"request\", requestListener);\n\t\t\t\tserver.close(err => {\n\t\t\t\t\tcallback(err);\n\t\t\t\t});\n\t\t\t\tfor (const socket of sockets) {\n\t\t\t\t\tsocket.destroy(new Error(\"Server is disposing\"));\n\t\t\t\t}\n\t\t\t},\n\t\t\tmodule(originalModule) {\n\t\t\t\tconst key = `${encodeURIComponent(\n\t\t\t\t\toriginalModule.identifier().replace(/\\\\/g, \"/\").replace(/@/g, \"_\")\n\t\t\t\t).replace(/%(2F|3A|24|26|2B|2C|3B|3D|3A)/g, decodeURIComponent)}`;\n\t\t\t\tconst active = activeModules.get(key) > 0;\n\t\t\t\treturn {\n\t\t\t\t\tclient: `${options.client}?${encodeURIComponent(urlBase + prefix)}`,\n\t\t\t\t\tdata: key,\n\t\t\t\t\tactive\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t});\n\tlisten(server);\n};\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA,YAAY;;AAEZ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAHA;AAAA;AAIAA,MAAM,CAACC,OAAO,GAAG,UAAAC,OAAO;EAAA,OAAI,UAACC,QAAQ,EAAEC,QAAQ,EAAK;IACnD,IAAMC,MAAM,GAAGF,QAAQ,CAACG,uBAAuB,CAAC,wBAAwB,CAAC;IACzE,IAAMC,aAAa,GAAG,IAAIC,GAAG,EAAE;IAC/B,IAAMC,MAAM,GAAG,0BAA0B;IAEzC,IAAMC,OAAO,GACZR,OAAO,CAACS,QAAQ,KAAK,OAAO,IAC3B,OAAOT,OAAO,CAACU,MAAM,KAAK,QAAQ,KACjC,KAAK,IAAIV,OAAO,CAACU,MAAM,IAAI,KAAK,IAAIV,OAAO,CAACU,MAAM,CAAE;IAEvD,IAAMC,YAAY,GACjB,OAAOX,OAAO,CAACU,MAAM,KAAK,UAAU,GACjCV,OAAO,CAACU,MAAM,GACb,YAAM;MACP,IAAME,IAAI,GAAGJ,OAAO,GAAGK,OAAO,CAAC,OAAO,CAAC,GAAGA,OAAO,CAAC,MAAM,CAAC;MACzD,OAAOD,IAAI,CAACD,YAAY,CAACG,IAAI,CAACF,IAAI,EAAEZ,OAAO,CAACU,MAAM,CAAC;IACnD,CAAC,EAAG;IACR,IAAMK,MAAM,GACX,OAAOf,OAAO,CAACe,MAAM,KAAK,UAAU,GACjCf,OAAO,CAACe,MAAM,GACd,UAAAL,MAAM,EAAI;MACV,IAAIK,MAAM,GAAGf,OAAO,CAACe,MAAM;MAC3B,IAAI,OAAOA,MAAM,KAAK,QAAQ,IAAI,EAAE,MAAM,IAAIA,MAAM,CAAC,EACpDA,MAAM,mCAAQA,MAAM;QAAEC,IAAI,EAAEC;MAAS,EAAE;MACxCP,MAAM,CAACK,MAAM,CAACA,MAAM,CAAC;IACrB,CAAC;IAEL,IAAMN,QAAQ,GAAGT,OAAO,CAACS,QAAQ,KAAKD,OAAO,GAAG,OAAO,GAAG,MAAM,CAAC;IAEjE,IAAMU,eAAe,GAAG,SAAlBA,eAAe,CAAIC,GAAG,EAAEC,GAAG,EAAK;MACrC,IAAMC,IAAI,GAAGF,GAAG,CAACG,GAAG,CAACC,KAAK,CAAChB,MAAM,CAACiB,MAAM,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC;MACpDN,GAAG,CAACO,MAAM,CAACC,EAAE,CAAC,OAAO,EAAE,YAAM;QAC5BC,UAAU,CAAC,YAAM;UAAA,2CACEP,IAAI;YAAA;UAAA;YAAtB,oDAAwB;cAAA,IAAbQ,GAAG;cACb,IAAMC,QAAQ,GAAGzB,aAAa,CAAC0B,GAAG,CAACF,GAAG,CAAC,IAAI,CAAC;cAC5CxB,aAAa,CAAC2B,GAAG,CAACH,GAAG,EAAEC,QAAQ,GAAG,CAAC,CAAC;cACpC,IAAIA,QAAQ,KAAK,CAAC,EAAE;gBACnB3B,MAAM,CAAC8B,GAAG,WACNJ,GAAG,mEACN;cACF;YACD;UAAC;YAAA;UAAA;YAAA;UAAA;QACF,CAAC,EAAE,MAAM,CAAC;MACX,CAAC,CAAC;MACFV,GAAG,CAACO,MAAM,CAACQ,UAAU,CAAC,IAAI,CAAC;MAC3Bd,GAAG,CAACe,SAAS,CAAC,GAAG,EAAE;QAClB,cAAc,EAAE,mBAAmB;QACnC,6BAA6B,EAAE,GAAG;QAClC,8BAA8B,EAAE,GAAG;QACnC,8BAA8B,EAAE;MACjC,CAAC,CAAC;MACFf,GAAG,CAACgB,KAAK,CAAC,IAAI,CAAC;MACf,IAAIC,eAAe,GAAG,KAAK;MAAC,4CACVhB,IAAI;QAAA;MAAA;QAAtB,uDAAwB;UAAA,IAAbQ,GAAG;UACb,IAAMC,QAAQ,GAAGzB,aAAa,CAAC0B,GAAG,CAACF,GAAG,CAAC,IAAI,CAAC;UAC5CxB,aAAa,CAAC2B,GAAG,CAACH,GAAG,EAAEC,QAAQ,GAAG,CAAC,CAAC;UACpC,IAAIA,QAAQ,KAAK,CAAC,EAAE;YACnB3B,MAAM,CAAC8B,GAAG,WAAIJ,GAAG,0CAAuC;YACxDQ,eAAe,GAAG,IAAI;UACvB;QACD;MAAC;QAAA;MAAA;QAAA;MAAA;MACD,IAAIA,eAAe,IAAIpC,QAAQ,CAACqC,QAAQ,EAAErC,QAAQ,CAACqC,QAAQ,CAACC,UAAU,EAAE;IACzE,CAAC;IAED,IAAM7B,MAAM,GAAG,mCAAqCC,YAAY,EAAG;IACnED,MAAM,CAACiB,EAAE,CAAC,SAAS,EAAET,eAAe,CAAC;IAErC,IAAIsB,SAAS,GAAG,KAAK;IACrB;IACA,IAAMC,OAAO,GAAG,IAAIC,GAAG,EAAE;IACzBhC,MAAM,CAACiB,EAAE,CAAC,YAAY,EAAE,UAAAD,MAAM,EAAI;MACjCe,OAAO,CAACE,GAAG,CAACjB,MAAM,CAAC;MACnBA,MAAM,CAACC,EAAE,CAAC,OAAO,EAAE,YAAM;QACxBc,OAAO,CAACG,MAAM,CAAClB,MAAM,CAAC;MACvB,CAAC,CAAC;MACF,IAAIc,SAAS,EAAEd,MAAM,CAACmB,OAAO,EAAE;IAChC,CAAC,CAAC;IACFnC,MAAM,CAACiB,EAAE,CAAC,aAAa,EAAE,UAAAmB,CAAC,EAAI;MAC7B,IAAIA,CAAC,CAACC,OAAO,KAAK,qBAAqB,EAAE5C,MAAM,CAAC6C,IAAI,CAACF,CAAC,CAAC;IACxD,CAAC,CAAC;IACFpC,MAAM,CAACiB,EAAE,CAAC,WAAW,EAAE,UAAAsB,GAAG,EAAI;MAC7B,IAAIA,GAAG,EAAE,OAAO/C,QAAQ,CAAC+C,GAAG,CAAC;MAC7B,IAAMC,IAAI,GAAGxC,MAAM,CAACyC,OAAO,EAAE;MAC7B,IAAI,OAAOD,IAAI,KAAK,QAAQ,EAAE,MAAM,IAAIE,KAAK,CAAC,2BAA2B,CAAC;MAC1E,IAAMC,OAAO,GACZH,IAAI,CAACC,OAAO,KAAK,IAAI,IAAID,IAAI,CAACC,OAAO,KAAK,SAAS,aAC7C1C,QAAQ,0BAAgByC,IAAI,CAAClC,IAAI,IACpCkC,IAAI,CAACI,MAAM,KAAK,MAAM,aACnB7C,QAAQ,iBAAOyC,IAAI,CAACC,OAAO,eAAKD,IAAI,CAAClC,IAAI,cACzCP,QAAQ,gBAAMyC,IAAI,CAACC,OAAO,cAAID,IAAI,CAAClC,IAAI,CAAE;MAChDb,MAAM,CAAC8B,GAAG,kEACiDoB,OAAO,OACjE;MACDnD,QAAQ,CAAC,IAAI,EAAE;QACdqD,OAAO,mBAACrD,QAAQ,EAAE;UACjBsC,SAAS,GAAG,IAAI;UAChB;UACA9B,MAAM,CAAC8C,GAAG,CAAC,SAAS,EAAEtC,eAAe,CAAC;UACtCR,MAAM,CAAC+C,KAAK,CAAC,UAAAR,GAAG,EAAI;YACnB/C,QAAQ,CAAC+C,GAAG,CAAC;UACd,CAAC,CAAC;UAAC,4CACkBR,OAAO;YAAA;UAAA;YAA5B,uDAA8B;cAAA,IAAnBf,MAAM;cAChBA,MAAM,CAACmB,OAAO,CAAC,IAAIO,KAAK,CAAC,qBAAqB,CAAC,CAAC;YACjD;UAAC;YAAA;UAAA;YAAA;UAAA;QACF,CAAC;QACDtD,MAAM,kBAAC4D,cAAc,EAAE;UACtB,IAAM7B,GAAG,aAAM8B,kBAAkB,CAChCD,cAAc,CAACE,UAAU,EAAE,CAACC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAClE,CAACA,OAAO,CAAC,gCAAgC,EAAEC,kBAAkB,CAAC,CAAE;UACjE,IAAMC,MAAM,GAAG1D,aAAa,CAAC0B,GAAG,CAACF,GAAG,CAAC,GAAG,CAAC;UACzC,OAAO;YACNmC,MAAM,YAAKhE,OAAO,CAACgE,MAAM,cAAIL,kBAAkB,CAACN,OAAO,GAAG9C,MAAM,CAAC,CAAE;YACnE0D,IAAI,EAAEpC,GAAG;YACTkC,MAAM,EAANA;UACD,CAAC;QACF;MACD,CAAC,CAAC;IACH,CAAC,CAAC;IACFhD,MAAM,CAACL,MAAM,CAAC;EACf,CAAC;AAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}